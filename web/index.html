<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f9;
        color: #333;
      }
      h2 {
        color: #004d99;
      }

      /* Tab navigation */
      .tab {
        overflow: hidden;
        background-color: #004d99;
      }
      .tab button {
        background-color: inherit;
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        color: #fff;
        font-weight: bold;
        font-size: medium;
        transition: 0.3s;
      }
      .tab button:hover {
        background-color: #003366;
      }
      .tab button.active {
        background-color: #00264d;
      }

      /* Tab content container */
      .tabcontent {
        display: none;
        padding: 20px;
        border: 1px solid #ddd;
        background-color: #fff;
        margin-top: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
      }

      /* Container styling */
      .container {
        padding: 15px;
        margin: 10px 0;
        background-color: #f9fafb;
        border-radius: 6px;
      }
      .output-header {
        font-size: 14px;
        color: #555;
        margin: 0 0 5px;
      }

      /* Input styling */
      input[type="text"],
      input[type="number"],
      input[type="password"],
      input[type="file"] {
        width: 100%;
        padding: 8px;
        margin: 8px 0;
        display: inline-block;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
      }

      /* Network list styling */
      #scanlist {
        list-style-type: none;
        padding: 0;
      }
      .network-item {
        display: flex;
        align-items: center;
        padding: 10px;
        background-color: #e3e7f1;
        margin: 5px 0;
        border-radius: 5px;
        cursor: pointer;
        transition: 0.2s;
      }
      .network-item:hover {
        background-color: #cfd8e3;
      }

      .network-info {
        flex-grow: 1;
      }
      .network-ssid {
        font-weight: bold;
      }
      .network-icon {
        font-size: 18px;
        margin-right: 10px;
        color: #004d99;
      }

      /* RSSI Bar Graph */
      .rssi-bar-container {
        display: flex;
        width: 100px;
        height: 10px;
        background-color: #ddd;
        border-radius: 5px;
        overflow: hidden;
        margin-left: 10px;
      }
      .rssi-bar {
        height: 100%;
        transition: width 0.3s;
      }
      .strong-signal {
        background-color: #5adb69;
      } /* Green for strong */
      .moderate-signal {
        background-color: #ffcc00;
      } /* Yellow for moderate */
      .weak-signal {
        background-color: #e36a64;
      } /* Red for weak */

      /* Buttons */
      button {
        background-color: #004d99;
        color: white;
        border: none;
        padding: 10px 20px;
        cursor: pointer;
        font-size: medium;
        border-radius: 5px;
        transition: background-color 0.3s;
      }
      button:hover {
        background-color: #003366;
      }
    </style>
  </head>
  <body>
    <h2>Device Management Portal</h2>
    <div class="tab">
      <button class="tablinks" onclick="openTab(event, 'Provisioning')">
        Provisioning
      </button>
      <button class="tablinks" onclick="openTab(event, 'OTA')">OTA</button>
      <button class="tablinks" onclick="openTab(event, 'DummyData')">
        Dummy Data
      </button>
    </div>

    <!-- Provisioning Tab -->
    <div id="Provisioning" class="tabcontent">
      <div class="container">
        <h3>Wi-Fi Provisioning</h3>
        <button onclick="startDummyScan()">Scan for Networks</button>
        <ul id="scanlist"></ul>
        <label>SSID:</label>
        <input type="text" id="ssid" readonly /><br />
        <label>Password:</label>
        <input type="password" id="password" /><br />
        <button onclick="connectToNetwork()">Connect</button>
        <div>
          Connection Status:
          <span id="connection-status" class="status-indicator"></span>
        </div>
      </div>
    </div>

    <!-- OTA Tab -->
    <div id="OTA" class="tabcontent">
      <h3>OTA Firmware Update</h3>
      <div class="container">
        <input type="file" id="ota-file" accept=".bin" />
        <button onclick="startOTA()">Upload</button>
        <div id="ota-status"></div>
      </div>
    </div>

    <!-- Dummy Data Tab -->
    <div id="DummyData" class="tabcontent">
      <h3>Dummy Data Inputs</h3>
      <div class="container">
        <label class="output-header" id="previousNumber"
          >Previous Number: 0</label
        >
        <label class="output-header" id="headerNumber">Number Output: </label>
        <input type="number" id="inputNumber" /><br />
        <button onclick="setNewValue('number')">Set Value</button><br /><br />

        <label class="output-header" id="previousText"
          >Previous Text: N/A</label
        >
        <label class="output-header" id="headerText">Text Output: </label>
        <input type="text" id="inputText" /><br />
        <button onclick="setNewValue('text')">Set Value</button>
      </div>
    </div>

    <script>
      // Open first tab by default
      document.querySelector(".tab button").click();

      // Tab switching functionality
      function openTab(evt, tabName) {
        document
          .querySelectorAll(".tabcontent")
          .forEach((tab) => (tab.style.display = "none"));
        document
          .querySelectorAll(".tablinks")
          .forEach(
            (btn) => (btn.className = btn.className.replace(" active", ""))
          );
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";
      }

      // Set new values and update previous values on success
      function setNewValue(type) {
        if (type === "number") {
          const newNumber = document.getElementById("inputNumber").value;
          if (newNumber === "") {
            alert("Please enter a valid number.");
            return;
          }
          document.getElementById("previousNumber").innerText =
            "Previous Number: " + newNumber;
          document.getElementById("headerNumber").innerText =
            "Number Output: " + newNumber;
        } else if (type === "text") {
          const newText = document.getElementById("inputText").value;
          if (newText === "") {
            alert("Please enter a valid text.");
            return;
          }
          document.getElementById("previousText").innerText =
            "Previous Text: " + newText;
          document.getElementById("headerText").innerText =
            "Text Output: " + newText;
        }
      }

      // Dummy scan list data for Provisioning Tab
      const dummyNetworks = [
        { ssid: "Arup", rssi: -50, protected: true },
        { ssid: "Joydeep", rssi: -70, protected: false },
        { ssid: "Tanmay", rssi: -65, protected: true },
        { ssid: "Afreen", rssi: -80, protected: false },
        { ssid: "Aksah", rssi: -90, protected: true },
      ];

      // Function to calculate signal strength based on RSSI
      function getSignalClass(rssi) {
        if (rssi > -60) return "strong-signal";
        else if (rssi > -80) return "moderate-signal";
        else return "weak-signal";
      }

      // Calculate width percentage for the RSSI bar based on RSSI value
      function calculateRSSIWidth(rssi) {
        return Math.max(0, Math.min(100, ((rssi + 100) * 100) / 60)) + "%";
      }

      // Show dummy scan list on button press
      function startDummyScan() {
        const scanList = document.getElementById("scanlist");
        scanList.innerHTML = ""; // Clear the previous scan list

        dummyNetworks.forEach((network) => {
          const listItem = document.createElement("li");
          listItem.className = "network-item";

          const icon = document.createElement("span");
          icon.className = "network-icon";
          icon.innerHTML = "ðŸ”’"; // Network icon

          const info = document.createElement("div");
          info.className = "network-info";
          info.innerHTML = `<span class="network-ssid">${network.ssid}</span>`;

          const rssiBarContainer = document.createElement("div");
          rssiBarContainer.className = "rssi-bar-container";

          const rssiBar = document.createElement("div");
          rssiBar.className = `rssi-bar ${getSignalClass(network.rssi)}`;
          rssiBar.style.width = calculateRSSIWidth(network.rssi);

          // Add onclick event to the list item
          listItem.onclick = function () {
            selectNetwork(network.ssid);
          };

          // Append elements to the list item
          rssiBarContainer.appendChild(rssiBar);
          listItem.appendChild(info);
          if (network.protected) {
            listItem.appendChild(icon);
          }
          listItem.appendChild(rssiBarContainer);
          scanList.appendChild(listItem);
        });
      }

      // Populate the SSID field when a network is selected
      function selectNetwork(ssid) {
        document.getElementById("ssid").value = ssid;
      }

      // Connect to the selected Wi-Fi network
      function connectToNetwork() {
        const ssid = document.getElementById("ssid").value;
        const password = document.getElementById("password").value;
        if (!ssid) {
          alert("Please select a network from the scan list.");
          return;
        }

        if (
          password === "" &&
          !confirm("No password provided. Continue with open connection?")
        ) {
          return;
        }

        // Dummy connection process
        const isConnected =
          ssid === "Network_1" && password === "correct_password";
        updateConnectionStatus(isConnected);
        alert(
          isConnected
            ? "Connection successful!"
            : "Connection failed. Check credentials."
        );
      }

      // Start OTA update process
      function startOTA() {
        const otaFile = document.getElementById("ota-file").files[0];
        if (!otaFile) {
          alert("Please select a firmware file to upload.");
          return;
        }
        // Simulate OTA update status
        document.getElementById("ota-status").innerText =
          "Uploading firmware...";
        setTimeout(() => {
          document.getElementById("ota-status").innerText =
            "Firmware uploaded successfully!";
        }, 2000);
      }
    </script>
  </body>
</html>
